
# Python Impacket
Init.

Python [impacket](https://github.com/fortra/impacket/tree/master) is an open-source collection of scripts designed to interact with common [networking](/networking/OSI/network-layer.md) protocols. Many of the scripts can be used in pen-testing, especially against Windows targets.
## Common Scripts:
(I'm keeping a list here for my own use/ reference)
### [`smbrelayx.py`](https://github.com/fortra/impacket/blob/master/examples/smbrelayx.py)
### [`ntlmrelayx.py`](https://github.com/fortra/impacket/blob/master/examples/ntlmrelayx.py)
```bash
ntlmrelayx.py -tf targets.txt -smb2support -c 'whoami'
```
- `tf`: target file
- `-smb2support`: support SMB version 2
- `-c`: command to execute on target system
- `-i`: interactive (will give you a shell)
### [`GetNPUsers.py`](https://github.com/fortra/impacket/blob/master/examples/GetNPUsers.py)
<<<<<<< HEAD
<<<<<<< HEAD:cybersecurity/tools/exploitation/impacket.md
Get's TGTs for users in an [active-directory](../../../hidden/HTB-notes/active-directory.md) environment who have *[kerberos](../../../networking/protocols/kerberos.md) pre-authentication turned off.* This is useful to know because having pre-auth turned off means we can ask for their TGTs without supplying a password. 

Once you have a TGT you can crack it with something like [john](../cracking/john.md).
#### Example
```bash
python3 GetNPUsers.py 
```
### [`GetUserSPNs.py`](https://github.com/fortra/impacket/blob/master/examples/GetUserSPNs.py)
`impacket-GetUserSPNs -usersfile [users.lst](https://users.lst) -dc-ip 10.10.10.175 -request 'EGOTISTICAL-BANK.LOCAL/' -no-pass`
### [`secretdump.py`](https://github.com/fortra/impacket/blob/master/impacket/examples/secretsdump.py)
Will attempt to dump hashes from a remote machine *without executing an agent there.*
=======
=======
>>>>>>> d3d8a3bb6ad799f2200e81ed1a41d783a93034cf
Gets [kerberos](../../../../networking/protocols/kerberos.md) TGTs from users which have the *`UF_DONT_REQUIRE_PREAUTH`* (which means they have pre-authentication turned off). 

From these types of users we can get their *AS_REP* which is *partially encrypted using their password*. 

Once we have the AS-REP, we can give it to [hashcat](../../cracking/tools/hashcat.md) for cracking (and getting the plaintext password).
### [`GetUserSPNs.py`](https://github.com/fortra/impacket/blob/master/examples/GetUserSPNs.py)
```bash
impacket-GetUserSPNs -usersfile users.lst -dc-ip 10.10.10.175 -request 'EGOTISTICAL-BANK.LOCAL/' -no-pass
<<<<<<< HEAD
>>>>>>> d3d8a3bb6ad799f2200e81ed1a41d783a93034cf:cybersecurity/TTPs/exploitation/tools/impacket.md
=======
>>>>>>> d3d8a3bb6ad799f2200e81ed1a41d783a93034cf
```
### [`secretdump.py`](https://github.com/fortra/impacket/blob/master/impacket/examples/secretsdump.py)
```bash
secretsdump.py 'egotistical-bank.local/svc_loanmgr:Moneymakestheworldgoround!@10.10.10.175'
````
<<<<<<< HEAD
<<<<<<< HEAD:cybersecurity/tools/exploitation/impacket.md
- The domain, user, password, and IP should be surrounded in quotes
=======
- The domain, user, password, and IP should be surround in quotesq
>>>>>>> d3d8a3bb6ad799f2200e81ed1a41d783a93034cf:cybersecurity/TTPs/exploitation/tools/impacket.md
=======
- The domain, user, password, and IP should be surround in quotesq
>>>>>>> d3d8a3bb6ad799f2200e81ed1a41d783a93034cf
